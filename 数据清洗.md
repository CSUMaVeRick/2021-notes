# 数据清洗

数据清洗是指发现并纠正数据文件中可识别的错误的最后一道程序。录入后的数据清理一般是由计算机而不是人工完成。

## 内容

**一致性检查**

根据每个变量的合理取值范围和相互关系，检查数据是否合乎要求，发现超出正常范围、逻辑上不合理或者相互矛盾的数据。例如，用1-7级量表测量的变量出现了0值，体重出现了负数，都应视为超出正常值域范围。

**无效值和缺失值的处理**

由于调查、编码和录入误差，数据中可能存在一些无效值和缺失值，需要给予适当的处理。常用的处理方法有：估算，整例删除，变量删除和成对删除。

## 类型

残缺数据、错误数据、重复数据

## 重复数据处理

`Pandas`提供了`duplicated`方法，该方法返回值是数据行每一行的检验结果，即每行返回一个bool值。使用`drop_duplicates`方法可以移除重复值。

```python
import pandas as pd
a=pd.read_excel(读入)
a.drop_duplicates(inplace=True)#这时会将重复数据行直接删除
f=pd.ExcelWriter(写入)
a.to_excel(f)
f.save(写入)
```

## 缺失数据处理

数据缺失是数据分析中的常见现象，`Pandas`使用浮点值NaN表示浮点或非浮点数组中的缺失数据，`Python`内置的None值也会被当做缺失值处理。使用`Pandas`的`isnull`检测是否为缺失值，检测对象的每个元素都会返回一个bool值。

```python
import numpy
import pandas
data=pandas.Series()
print(data.isnull())
print(any(data.isnull()))
```

处理缺失值可以使用过滤、填充、插值。

### 过滤

过滤使用`dropna`方法。`dropna(axis=0,how='any',thresh=None)`，其中`axis`取值0或1，0表示删除行，1表示删除列；`how`可选any或all，all表示删除全部缺失行；`thresh`接收整型的参数，一行中至少有给定个非NaN值时，才会被保留。

```python
import pandas as pd
a=pd.read_excel()
b=a.dropna()
```

### 填充

也可以利用`fillna`进行数据填充。`fillna(value=None,method=None,axis=None,inplace=False)`

`value`的取值除了基本类型外，还可以用字典，针对不同列给出不同的填充值。`method`用来指定填补方法。

```python
import pandas
a=read_excel()
b1=a.fillna(method='ffill')
b2=a.fillna(method='bfill')
b3=a.fillna(value={'attr1':a.attr1.mode()[0],'attr2':a.attr2.mean(),'attr3':a.attr3.median()})
```

### 插值

也可通过`interpolate`利用插值法进行处理。`interpolate(method='linear')`

`method`取值有linear、nearest、zero、slinear、quadratic、cubic、spline、barycentric、polynomial。

## 异常数据处理